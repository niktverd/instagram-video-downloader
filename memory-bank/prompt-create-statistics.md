# Инструкция: Как добавить раздел со статистикой для сущности

## 1. Определи бизнес-логику статистики

- Что именно нужно считать? (например, количество созданных записей по дням)
- Какие параметры нужны на вход? (например, массив дат, диапазон, фильтры)
- Какой формат ответа ожидается?

## 2. Добавь схему параметров запроса и тип ответа

- В файле schemas/handlers/{entity}.ts определи Zod-схему для параметров (например, массив дат)
- Определи тип для ответа (например, Record<string, number>)
- Экспортируй эти сущности

## 3. Добавь типы в sharedTypes/types/{entity}.ts

- Импортируй схему параметров
- Добавь типы Params и Response для статистики
- Экспортируй их

## 4. Реализуй функцию в слое db

- В src/db/{entity}.ts создай функцию get{Entity}StatisticsByDays
- Принимай params: { days: string[] }, db
- Используй query с group by/aggregation для подсчёта
- Возвращай { result, code: 200 }

## 5. Добавь функцию в экспорт db/index.ts

- Экспортируй новую функцию, чтобы она была доступна контроллерам

## 6. Добавь контроллер

- В src/sections/ui/controllers/{entity}.controller.ts импортируй функцию, схему и типы
- Создай handler через wrapper<Params, Response>(...)
- Экспортируй его

## 7. Добавь роут

- В src/sections/ui/routes.ts импортируй handler
- Добавь GET/POST роут (например, /get-{entity}-statistics-by-days)

## 8. Проверь интеграцию

- Убедись, что endpoint доступен и возвращает ожидаемый формат
- Проверь edge-кейсы (пустой массив, несуществующие даты)

## 9. Напиши тесты

- В testApi/{entity}.controller.test.ts добавь тест
- Создай тестовые записи с нужными датами
- Проверь, что статистика корректна для разных дней

## 10. Проверь кодстайл и типы

- Убедись, что нет ошибок линтера и TS
- Проверь сортировку импортов и чистоту экспорта

---

> Можно начинать с любого шага — инструкция покрывает весь цикл добавления статистики для новой сущности.
