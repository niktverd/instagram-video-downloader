# Идеи для решения проблемы наблюдаемости

1. **Единая таблица статусов (VideoProcessStatus)**

   - Ввести отдельную таблицу (или коллекцию), где для каждого видео хранится текущий статус (enum: received, downloading, downloaded, processing, processed, publishing, published, error и т.д.), ссылка на связанные сущности и история переходов.
   - Все этапы пайплайна обновляют статус централизованно.

2. **Event Sourcing / Лог событий**

   - Вместо (или вместе с) статусом — писать в отдельную таблицу/коллекцию события: "скачивание начато", "скачивание завершено", "ошибка скачивания", "отправлено в pubsub", "cloud-run завершён" и т.д.
   - Позволяет строить таймлайны, видеть все переходы и причины ошибок.

3. **Дашборд мониторинга**

   - Сделать простую админку/дашборд (или даже Google Data Studio/Grafana), где визуализируются статусы, ошибки, "живые" процессы, тайминги этапов.
   - Можно строить поверх таблицы статусов или event log.

4. **Централизованный лог ошибок и алерты**

   - Все ошибки с этапов пайплайна (скачивание, cloud-run, публикация) логировать в одну таблицу/коллекцию с привязкой к видео и этапу.
   - Добавить алерты (например, через Telegram/Slack/email) при критических ошибках или зависших процессах.

5. **Трассировка процессов (Trace ID)**
   - Для каждого видео генерировать traceId, который прокидывается через все этапы (webhook → pubsub → cloud-run → публикация).
   - Все логи, статусы и ошибки помечаются этим traceId, что позволяет быстро находить всю историю по одному видео.
